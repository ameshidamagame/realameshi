/* Essentials YOOtheme Pro 1.5.8; ZOOlanders https://www.zoolanders.com; Copyright (C) Joolanders, SL; http://www.gnu.org/licenses/gpl.html GNU/GPL */

!function(r,o){"use strict";function i(r){return r&&"object"==typeof r&&"default"in r?r:{default:r}}function n(){return(n=Object.assign||function(r){for(var i=1;i<arguments.length;i++){var t,s=arguments[i];for(t in s)Object.prototype.hasOwnProperty.call(s,t)&&(r[t]=s[t])}return r}).apply(this,arguments)}var t={connected:function(){this.$submit=o.$('button[type="submit"]',this.$el),this.$errors=o.$("[data-yooessentials-form-errors]",this.$el),this.$fields=o.$$("[data-yooessentials-form-field]",this.$el).reduce(function(r,i){return n({},r,((r={})[i.dataset.yooessentialsFormField]=i,r))},{}),o.removeAttr(this.$submit,"disabled")},props:{errors:Array,action:String,validateAction:String,validationErrors:Array},data:function(){return{action:"",errors:[],submitting:!1,validateAction:"",validationErrors:[]}},events:{submit:function(r){r.preventDefault(),this.submit()}},methods:{submit:function(){o.trigger(this.$el,"form:submit")&&o.trigger(document,"yooessentials-form:submit",[{form:this.$el}])&&this.doSubmit()},enableSpinner:function(){var r=o.$$("> span",this.$submit),i=r[0],r=r[1];o.addClass(i,"uk-invisible"),o.removeClass(r,"uk-hidden")},disableSpinner:function(){var r=o.$$("> span",this.$submit),i=r[0],r=r[1];o.removeClass(i,"uk-invisible"),o.addClass(r,"uk-hidden")},doSubmit:function(r){var e=this;void 0===r&&(r={}),this.submitting=!0,setTimeout(function(){!0===e.submitting&&e.enableSpinner()},200);var i,t=new FormData(this.$el);for(i in r)t.append(i,r[i]);o.ajax(this.validateAction||this.action,{method:"POST",data:t,responseType:"json",headers:{"X-Requested-With":"XMLHttpRequest"}}).then(function(r){r=r.response;o.trigger(e.$el,"form:submitted",[{response:r}]),o.trigger(document,"yooessentials-form:submitted",[{form:e.$el,response:r}]),e.validateAction&&e.$el.submit(),e.resetForm()}).catch(function(r){e.submitting=!1,e.disableSpinner(),e.resetErrorsDisplay(),e.resetValidationErrorsDisplay();var i=null==r?void 0:r.xhr.response,t=e.validationErrors=null!=(t=null==i?void 0:i.validation)?t:[],s=e.errors=null!=(i=null==i?void 0:i.errors)?i:[(null==r||null==(s=r.xhr)?void 0:s.statusText)||"Submission Failed"];e.displayValidationErrors(),e.displayErrors();t={error:r,errors:s,validation:t};o.trigger(e.$el,"form:submission-error",[t]),o.trigger(document,"yooessentials-form:submission-error",[n({form:e.$el},t)])})},displayErrors:function(){var r;this.resetErrorsDisplay(),this.errors.length&&(r=this.errors.map(function(r){return"<li>"+r+"</li>"}),o.html(this.$errors,'<div class="uk-alert-warning uk-margin-top" uk-alert>\n                <a class="uk-alert-close" uk-close></a>\n                <ul class="uk-list">'+r+"</ul>\n            </div>"))},displayValidationErrors:function(){this.resetValidationErrorsDisplay();var r,i=this.validationErrors;for(r in i){var t=this.$fields[r],s=i[r];if(!t)return void this.errors.push(i[r]);var e=o.$$("[name]",t),t=o.$$("[data-yooessentials-form-field-errors]",t);o.addClass(e,"uk-form-danger"),o.html(t,'<ul class="uk-list">'+s.map(function(r){return"<li>"+r+"</li>"})+"</ul>")}},resetForm:function(){this.errors=[],this.validationErrors=[],this.submitting=!1,this.$el.reset(),this.disableSpinner(),this.resetErrorsDisplay(),this.resetValidationErrorsDisplay()},resetErrorsDisplay:function(){o.empty(this.$errors)},resetValidationErrorsDisplay:function(){for(var r in this.$fields){var i=this.$fields[r],r=o.$$("[name]",i),i=o.$$("[data-yooessentials-form-field-errors]",i);o.removeClass(r,"uk-form-danger"),o.empty(i)}}}};i(r).default.component("yooessentials-form",t)}(UIkit,UIkit.util);